---
title: "Toronto Neighbourhood Crime Rates - Analysis"
subtitle: "Using Simple Linear Regression Model"
author: "Md Abrar Nasir"
date: "February 14, 2020"
output: pdf_document
---

```{r, include = FALSE}

library(tidyverse)
library(opendatatoronto)
library(ggplot2)
library(patchwork)

df <- search_packages("Neighbourhood Crime Rates")
df <- df %>% list_package_resources()
df <- df %>% get_resource()

df <- drop_na(df)
df <- select(df, Neighbourhood, Population, Assault_2016, AutoTheft_2016, BreakandEnter_2016, Homicide_2016, Robbery_2016, TheftOver_2016)

```


## Introduction

Criminal activities or crime rates have always been a serious point of concern for citizens and authorities in a city. In this analysis, we are to investigate the relationship between the population of a city, which, in our case, is Toronto and its crime rates, based off 2016 data, over varying types of crime categories in question, such as assault, auto theft, robbery etc.

The data for this exploration has been sourced from the [Open Data Toronto Portal](https://open.toronto.ca/dataset/neighbourhood-crime-rates/), published by the Toronto Police Services.


## Model

The mathematical model which is to be used is simple linear regression (SLR) which will exhibit the relationship between our response variables, *number of assaults*, *number of auto thefts*, *number of break-and-enters*, *number of homicides*, *number of robberies* and *number of thefts* and the predictor, *population in Toronto in 2016* by means of the linear equation:
$$Y_i = \alpha + \beta x_i + U_i$$
where $Y_i$ is our response variable, $x_i$ is our predictor, and $\alpha$ and $\beta$ are the $y-$intercept and the slope of the line respectively.

It should also be mentioned that $U_i$ represents any random fluctuation in the relationship, which, for the benefit of simplification, will be assumed to be independent and have an expectation of zero. Also, it should be considered that the variance is same for each $U_i$. The values of $x_i$ are to be taken as non-random while the values of $y_i$ should be realizations of random variable, $Y_i$ such that $(x_i, y_i)$ is the placeholder for our bivariate dataset containing the regressors and the regressands resprectively.

In layman's terms, this can be explained as drawing a straight line of best fit to express the relationship between our $x_i$ and $y_i$ and then computing the values of the slope and the intercept, to predict crime rates of a certain category using the population number.

```{r, echo = FALSE, message = FALSE}

p1 <- ggplot(df, aes(Population, Assault_2016)) + geom_point(size = 0.75, col = "#390099") + ggtitle("Scatterplot showing Population \n and Number of Assaults") + theme(plot.title = element_text(size = 7, face = "bold", hjust = 0.5), axis.title = element_text(size = 6.75)) +labs(x = "Population in 2016", y = "Number of Assaults in 2016")
p2 <- ggplot(df, aes(Population, AutoTheft_2016)) + geom_point(size = 0.75,col = "#9E0059") + ggtitle("Scatterplot showing Population \n and Number of Auto Thefts") + theme(plot.title = element_text(size = 7, face = "bold", hjust = 0.5), axis.title = element_text(size = 6.75)) + xlab("Population in 2016") + ylab("Number of Auto Thefts in 2016")
p3 <- ggplot(df, aes(Population, BreakandEnter_2016)) + geom_point(size = 0.75, col = "#FF0054") + ggtitle("Scatterplot showing Population \n and Number of Break-and-Enters") + theme(plot.title = element_text(size = 7, face = "bold", hjust = 0.5), axis.title = element_text(size = 6.75)) + xlab("Population in 2016") + ylab("Number of Break-and-Enters in 2016") 
p4 <- ggplot(df, aes(Population, Homicide_2016)) + geom_point(size = 0.75, col = "#FF5400") + ggtitle("Scatterplot showing Population \n and Number of Homicides") + theme(plot.title = element_text(size = 7, face = "bold", hjust = 0.5), axis.title = element_text(size = 6.75)) + xlab("Population in 2016") + ylab("Number of Homicides in 2016")
p5 <- ggplot(df, aes(Population, Robbery_2016)) + geom_point(size = 0.75, col = "#FFBD00") + ggtitle("Scatterplot showing Population \n and Number of Robberies") + theme(plot.title = element_text(size = 7, face = "bold", hjust = 0.5), axis.title = element_text(size = 6.75)) + xlab("Population in 2016") + ylab("Number of Robberies in 2016") 
p6 <- ggplot(df, aes(Population, TheftOver_2016)) + geom_point(size = 0.75, col = "#06D6A0") + ggtitle("Scatterplot showing Population \n and Number of Thefts") + theme(plot.title = element_text(size = 7, face = "bold", hjust = 0.5), axis.title = element_text(size = 6.75)) + xlab("Population in 2016") + ylab("Number of Thefts in 2016")

(p1 | p2 | p3) /
  (p4 | p5 | p6)

```

